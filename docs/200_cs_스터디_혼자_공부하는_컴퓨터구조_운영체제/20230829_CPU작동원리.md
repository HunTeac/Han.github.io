---
layout: default
title: CPU의 작동 원리
parent: CS 스터디 컴퓨터 구조, 운영체제
nav_order: 4
---

# CPU의 작동 원리

## 04 - 1 ALU와 제어장치
- CPU의 구성 요소: ALU와 제어 장치
- ALU와 제어 장치의 정보 처리 방식 및 역할

## ALU
- ALU가 연산을 하기 위해서는 피연산자와 수행할 연산이 필요하다.
- ALU는 레지스터로부터 피연산자를 받아들이고, 제어장치로부터 수행할 연산을 알려 주는 제어 신호를 받아들인다.
- 연산 수행 후, 연산 결과는 메모리에 바로 저장되지 않고 레지스터에 저장된다. 이때, 연산 결과는 특정 숫자나 문자가 될 수도 있고, 메모리 주소가 될 수도 있다.

### 플래그
- ALU는 연산 결과와 더불어 플래그를 내보낸다.
- 연산 결과값이 음수일 경우 음수라는 정보를 보내거나, 연산 결과가 연산 결과를 담을 레지스터보다 클 때 ‘결과값이 너무 크다’는 정보도 보낸다.

| 플래그 종류 | 의미 | 사용 예시 |
| -- | -- | -- |
| 부호 플래그 | 연산 결과의 부호 나타냄 | 1일 경우 결과는 음수, 0일 경우 결과는 양수 |
| 제로 플래그 |	연산 결과가 0인지 | 1인 경우 연산 결과는 0, 0일 경우 연산 결과는 0이 아님 |
| 캐리 플래그 | 연산 결과 올림수나 빌림수가 발생했는지 | 1일 경우 올림수나 빌림수가 발생했고, 0일 경우 발생하지 않았음 |
| 오버플로우 플래그 | 오버플로우가 발생했는지 | 1일 경우 오버플로우 발생, 0일 경우 발생하지 않았음 |
| 인터럽트 플래그 | 인터럽트가 가능한지 | 1일 경우 인터럽트 가능, 0일 경우 인터럽트 불가능 |
| 슈퍼바이저 플래그 | 커널 모드로 실행 중인지, 사용자 모드로 실행 중인지 | 1일 경우 커널 모드, 0일 경우 사용자 모드 |

- 플래그들은 플래그 레지스터에 저장되고 이 정보를 읽음으로써 연산 결과에 대한 추가 정보를 얻을 수 있다. 

## 제어장치

### 제어장치가 받아들이는 정보
- 클럭 신호
- 해석해야 할 명령어
- 플래그 레지스터 속 플래그 값
- 제어 신호 in 시스템 버스

1. 클럭 신호
2. 클럭(clock)이란 컴퓨터의 모든 부품을 일사불란하게 움직일 수 있게 하는 시간 단위
3. 해석해야 할 명령어
4. CPU가 해석해야 할 명령어는 명령어 레지스터에 저장되고, 제어장치는 이 명령어 레지스터로부터 해석할 명령어를 받아들이고 해석한 후, 제어 신호를 발생시켜 컴퓨터 부품들에 수행해야 할 내용을 알려줌.
5. 플래그 레지스터 속 플래그 값
6. 플래그 값을 참고하여 제어 신호 발생기킴
7. 시스템 버스 중 제어 버스로 전달된 제어 신호

### 제어장치가 내보내는 정보
1. CPU 외부에 전달하는 제어 신호 - 제어 버스에 제어 신호 전달
    - 메모리에 전달하는 제어 신호: 메모리에 저장된 값을 읽거나 쓸 때
    - 입출력 장치에 전달하는 제어 신호: 입출력장치의 값을 읽거나 입출력장치에 새로운 값을 쓰고 싶을 때

2. CPU 내부에 전달하는 제어 신호
    - ALU에 전달하는 제어 신호: 수행할 연산을 지시하기 위해
    - 레지스터에 전달하는 제어 신호: 레지스터 간 데이터 이동, 저장된 명령어 해석

## 04 - 2 레지스터
- 레지스터의 종류와 역할
- 명령어가 처리되는 과정

### 알아야 할 레지스터
1. 프로그램 카운터
2. 명령어 레지스터
3. 메모리 주소 레지스터
4. 메모리 버퍼 레지스터
5. 플래그 레지스터
6. 범용 레지스터
7. 스택 포인터
8. 베이스 레지스터

### 프로그램 카운터 (PC, Program Counter) 
- = 명령어 포인터 IP: Instruction Pointer
- 메모리에서 가져올 명령어의 주소 저장

### 명령어 레지스터 (IR, Instruction Register)
- 방금 메모리에서 읽어 들인 명령어 저장
- 제어 장치는 명령어 레지스터 내부 명령어를 받아들이고 해석한 뒤 제어 신호 내보냄

### 메모리 주소 레지스터 MAR: Memory Address Register
- CPU가 읽어 들이고자 하는 주소값을 주소 버스로 보낼 때 메모리 주소 레지스터를 거침

### 메모리 버퍼 레지스터 MBR: Memory Buffer Register
- 메모리와 주고받을 값(데이터와 명령어)을 지정하는 레지스터
- 메모리에 쓰고 싶은 값이나 메모리로부터 전달받은 값은 메모리 버퍼 레지스터를 거침
- CPU가 주소 버스로 내보낼 값이 메모리 레지스터를 거친다면, 데이터 버스로 주고받을 값은 메모리 버퍼 레지스터를 거침

### 범용 레지스터 (General Purpose Register)
- 다양하고 일반적인 상황에서 자유롭게 사용할 수 있는 레지스터
- 데이터와 주소를 모두 저장할 수 있고 일반적으로 CPU 안에는 여러 개의 범용 레지스터가 있다.

### 플래그 레지스터
- ALU 연산 결과에 따른 플래그를 플래그 레지스터에 저장한다. 
- 연산 결과 또는 CPU 상태에 대한 부가적인 정보 저장